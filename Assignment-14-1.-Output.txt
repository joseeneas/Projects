python -u "/Users/eneas/Desktop/MIT/Projects/Assignment-14-1.py"
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(1) Importing Libraries
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 2.21238923072814941406 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------(2) Importing Data
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00769305229187011719 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------(3) Data Exploration
----------------------------------------------------------------------------------------------------
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 8603 entries, 0 to 8602
Data columns (total 11 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   attendees      8603 non-null   int64  
 1   month          8603 non-null   int64  
 2   day            8603 non-null   int64  
 3   hour           8603 non-null   int64  
 4   day_of_week    8603 non-null   object 
 5   holiday        8603 non-null   int64  
 6   temp           8603 non-null   float64
 7   temp_wb        8603 non-null   int64  
 8   rel_humidity   8603 non-null   int64  
 9   windspeed      8603 non-null   int64  
 10  precipitation  8603 non-null   float64
dtypes: float64(2), int64(8), object(1)
memory usage: 739.4+ KB
-------------------------------------------------Elapsed Time --- 0.00509381294250488281 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(4) Data Cleaning - Categorical Variables
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00186276435852050781 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------(5) Data Exploration
----------------------------------------------------------------------------------------------------
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 8603 entries, 0 to 8602
Data columns (total 11 columns):
 #   Column         Non-Null Count  Dtype   
---  ------         --------------  -----   
 0   attendees      8603 non-null   int64   
 1   month          8603 non-null   category
 2   day            8603 non-null   category
 3   hour           8603 non-null   category
 4   day_of_week    8603 non-null   category
 5   holiday        8603 non-null   category
 6   temp           8603 non-null   float64 
 7   temp_wb        8603 non-null   int64   
 8   rel_humidity   8603 non-null   int64   
 9   windspeed      8603 non-null   int64   
 10  precipitation  8603 non-null   float64 
dtypes: category(5), float64(2), int64(4)
memory usage: 448.3 KB
----------------------------------------------------------------------------------------------------
<bound method DataFrame.items of       attendees month day hour day_of_week holiday  temp  temp_wb  rel_humidity  windspeed  precipitation
0           440     1   1    0         Mon       0   6.6        0            59         16          1.000
1           660     1   1    1         Mon       0   4.8        0            59         11          1.000
2           660     1   1    2         Mon       0   4.8       -1            54         21          1.000
3           110     1   1    5         Mon       0   3.0       -2            54         18          1.000
4           330     1   1    6         Mon       0   3.0       -2            54         15          1.000
...         ...   ...  ..  ...         ...     ...   ...      ...           ...        ...            ...
8598       3960    12  31   19         Mon       0  73.2       36            76         13          0.050
8599       2750    12  31   20         Mon       0  71.4       36            86         14          0.100
8600       1430    12  31   21         Mon       0  69.6       36            89         15          0.175
8601        660    12  31   22         Mon       0  71.4       37            89         14          0.225
8602        770    12  31   23         Mon       0  73.2       38            89         17          0.475

[8603 rows x 11 columns]>
----------------------------------------------------------------------------------------------------
Index           :  RangeIndex(start=0, stop=8603, step=1)
----------------------------------------------------------------------------------------------------
           attendees         temp      temp_wb  rel_humidity    windspeed  precipitation
count    8603.000000  8603.000000  8603.000000   8603.000000  8603.000000    8603.000000
mean    22559.436243    98.778287    47.835871     67.105196    11.101476       0.930024
std     24975.770785    32.920431    16.913790     18.923185     5.455005       0.242744
min       110.000000    -0.600000    -3.000000     16.000000     0.000000       0.025000
25%      3520.000000    71.400000    34.000000     53.000000     7.000000       1.000000
50%     13200.000000    96.600000    48.000000     68.000000    10.000000       1.000000
75%     33660.000000   127.200000    62.000000     84.000000    14.000000       1.000000
max    142890.000000   177.600000    81.000000    100.000000    48.000000       2.800000
----------------------------------------------------------------------------------------------------
Rows and Columns:  (8603, 11)
----------------------------------------------------------------------------------------------------
Column Names    :  Index(['attendees', 'month', 'day', 'hour', 'day_of_week', 'holiday', 'temp',
       'temp_wb', 'rel_humidity', 'windspeed', 'precipitation'],
      dtype='object')
-------------------------------------------------Elapsed Time --- 0.01048517227172851562 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(6) Data Exploration - Histogram
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.81890892982482910156 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(7) Data Exploration - Sample Data - Head
----------------------------------------------------------------------------------------------------
   attendees month day hour day_of_week holiday  temp  temp_wb  rel_humidity  windspeed  precipitation
0        440     1   1    0         Mon       0   6.6        0            59         16            1.0
1        660     1   1    1         Mon       0   4.8        0            59         11            1.0
2        660     1   1    2         Mon       0   4.8       -1            54         21            1.0
3        110     1   1    5         Mon       0   3.0       -2            54         18            1.0
4        330     1   1    6         Mon       0   3.0       -2            54         15            1.0
5        330     1   1    7         Mon       0   3.0       -2            54         11            1.0
6        220     1   1    8         Mon       0   4.8       -1            51         15            1.0
7        880     1   1    9         Mon       0  10.2        2            49         18            1.0
8       1320     1   1   10         Mon       0  15.6        4            45         21            1.0
9       1760     1   1   11         Mon       0  19.2        6            43         16            1.0
-------------------------------------------------Elapsed Time --- 0.00306892395019531250 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------(8) Data Splitting - Train and Test
----------------------------------------------------------------------------------------------------
Train data: 6022
Test data : 2581
Total data: 8603
-------------------------------------------------Elapsed Time --- 0.00068688392639160156 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------(9) Data Splitting - X and y - X_train and y_train
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00029325485229492188 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------(10) Data Splitting - Create Linear Regression Formula
----------------------------------------------------------------------------------------------------
Formula:  attendees ~ month+day+hour+day_of_week+holiday+temp+temp_wb+rel_humidity+windspeed+precipitation
-------------------------------------------------Elapsed Time --- 0.00001716613769531250 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(11) Fit Linear Regression Model
----------------------------------------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:              attendees   R-squared:                       0.695
Model:                            OLS   Adj. R-squared:                  0.691
Method:                 Least Squares   F-statistic:                     180.7
Date:                Tue, 06 May 2025   Prob (F-statistic):               0.00
Time:                        14:36:23   Log-Likelihood:                -66004.
No. Observations:                6022   AIC:                         1.322e+05
Df Residuals:                    5946   BIC:                         1.327e+05
Df Model:                          75                                         
Covariance Type:            nonrobust                                         
======================================================================================
                         coef    std err          t      P>|t|      [0.025      0.975]
--------------------------------------------------------------------------------------
Intercept          -3.575e+04   3059.416    -11.684      0.000   -4.17e+04   -2.98e+04
month[T.2]          3110.3229    952.018      3.267      0.001    1244.022    4976.624
month[T.3]          2074.2791    945.327      2.194      0.028     221.096    3927.463
month[T.4]          5207.7716    967.047      5.385      0.000    3312.008    7103.535
month[T.5]          1.099e+04   1151.300      9.542      0.000    8728.743    1.32e+04
month[T.6]          1.437e+04   1240.137     11.584      0.000    1.19e+04    1.68e+04
month[T.7]          1.535e+04   1401.392     10.955      0.000    1.26e+04    1.81e+04
month[T.8]          1.514e+04   1419.848     10.662      0.000    1.24e+04    1.79e+04
month[T.9]          2.079e+04   1292.558     16.086      0.000    1.83e+04    2.33e+04
month[T.10]         1.798e+04   1071.415     16.781      0.000    1.59e+04    2.01e+04
month[T.11]         9988.9448    969.195     10.306      0.000    8088.971    1.19e+04
month[T.12]         4380.7284    928.038      4.720      0.000    2561.436    6200.021
day[T.2]           -2420.3577   1405.876     -1.722      0.085   -5176.385     335.669
day[T.3]           -1135.7559   1403.445     -0.809      0.418   -3887.018    1615.506
day[T.4]           -2141.3127   1431.131     -1.496      0.135   -4946.849     664.224
day[T.5]               7.6914   1418.553      0.005      0.996   -2773.188    2788.571
day[T.6]            -616.8669   1406.115     -0.439      0.661   -3373.364    2139.630
day[T.7]            2061.1264   1416.950      1.455      0.146    -716.610    4838.863
day[T.8]             152.4361   1385.647      0.110      0.912   -2563.935    2868.807
day[T.9]            -303.7730   1404.727     -0.216      0.829   -3057.548    2450.002
day[T.10]            498.1928   1390.235      0.358      0.720   -2227.172    3223.558
day[T.11]            139.1472   1400.706      0.099      0.921   -2606.745    2885.040
day[T.12]             97.0152   1399.101      0.069      0.945   -2645.730    2839.760
day[T.13]            539.2754   1448.851      0.372      0.710   -2300.999    3379.550
day[T.14]           3291.6297   1414.998      2.326      0.020     517.721    6065.539
day[T.15]            741.6481   1392.079      0.533      0.594   -1987.332    3470.628
day[T.16]            560.6142   1436.674      0.390      0.696   -2255.789    3377.017
day[T.17]            423.9306   1409.608      0.301      0.764   -2339.413    3187.274
day[T.18]           -776.0686   1403.540     -0.553      0.580   -3527.516    1975.379
day[T.19]           -817.2770   1407.753     -0.581      0.562   -3576.984    1942.430
day[T.20]           1944.6002   1389.347      1.400      0.162    -779.025    4668.225
day[T.21]            843.7644   1411.828      0.598      0.550   -1923.931    3611.460
day[T.22]          -2515.2232   1413.080     -1.780      0.075   -5285.373     254.926
day[T.23]          -1300.5669   1407.868     -0.924      0.356   -4060.500    1459.366
day[T.24]           -614.1765   1393.093     -0.441      0.659   -3345.145    2116.792
day[T.25]          -1687.6345   1396.148     -1.209      0.227   -4424.591    1049.322
day[T.26]           -781.2472   1391.102     -0.562      0.574   -3508.312    1945.818
day[T.27]          -1499.5584   1409.527     -1.064      0.287   -4262.743    1263.626
day[T.28]          -1928.9510   1409.412     -1.369      0.171   -4691.911     834.009
day[T.29]           -666.0194   1433.632     -0.465      0.642   -3476.458    2144.420
day[T.30]           -447.0490   1431.289     -0.312      0.755   -3252.894    2358.796
day[T.31]           1941.1185   1649.695      1.177      0.239   -1292.883    5175.120
hour[T.1]          -1593.0540   1251.303     -1.273      0.203   -4046.062     859.954
hour[T.2]          -3136.9880   1269.210     -2.472      0.013   -5625.101    -648.875
hour[T.3]          -5317.4603   1333.756     -3.987      0.000   -7932.107   -2702.814
hour[T.4]          -3153.6667   1282.608     -2.459      0.014   -5668.045    -639.289
hour[T.5]          -1367.6396   1280.527     -1.068      0.286   -3877.938    1142.659
hour[T.6]           5811.7031   1305.534      4.452      0.000    3252.383    8371.024
hour[T.7]           2.472e+04   1268.276     19.488      0.000    2.22e+04    2.72e+04
hour[T.8]           4.467e+04   1272.372     35.107      0.000    4.22e+04    4.72e+04
hour[T.9]           2.298e+04   1287.819     17.848      0.000    2.05e+04    2.55e+04
hour[T.10]          1.416e+04   1292.717     10.952      0.000    1.16e+04    1.67e+04
hour[T.11]          1.645e+04   1300.956     12.646      0.000    1.39e+04     1.9e+04
hour[T.12]           2.04e+04   1301.879     15.670      0.000    1.78e+04     2.3e+04
hour[T.13]          1.951e+04   1295.077     15.063      0.000     1.7e+04     2.2e+04
hour[T.14]          1.963e+04   1281.165     15.325      0.000    1.71e+04    2.21e+04
hour[T.15]          2.377e+04   1285.691     18.485      0.000    2.12e+04    2.63e+04
hour[T.16]          3.905e+04   1286.595     30.351      0.000    3.65e+04    4.16e+04
hour[T.17]          5.449e+04   1288.906     42.276      0.000     5.2e+04     5.7e+04
hour[T.18]          3.816e+04   1275.107     29.925      0.000    3.57e+04    4.07e+04
hour[T.19]          2.561e+04   1272.935     20.121      0.000    2.31e+04    2.81e+04
hour[T.20]          1.571e+04   1279.673     12.276      0.000    1.32e+04    1.82e+04
hour[T.21]          1.066e+04   1277.236      8.347      0.000    8157.451    1.32e+04
hour[T.22]          6512.9264   1279.406      5.091      0.000    4004.826    9021.027
hour[T.23]          3186.6619   1254.346      2.540      0.011     727.689    5645.635
day_of_week[T.Mon] -1426.1284    678.476     -2.102      0.036   -2756.187     -96.069
day_of_week[T.Sat] -1908.9408    398.596     -4.789      0.000   -2690.334   -1127.548
day_of_week[T.Sun] -2651.1770    397.148     -6.676      0.000   -3429.731   -1872.623
day_of_week[T.Thu]   513.8702    696.986      0.737      0.461    -852.475    1880.215
day_of_week[T.Tue]  -770.5605    686.317     -1.123      0.262   -2115.991     574.870
day_of_week[T.Wed]   480.5871    692.796      0.694      0.488    -877.544    1838.719
holiday[T.1]       -4560.1178    397.123    -11.483      0.000   -5338.623   -3781.612
temp                 825.8548     81.442     10.140      0.000     666.199     985.510
temp_wb            -1315.3162    170.757     -7.703      0.000   -1650.061    -980.571
rel_humidity         114.7896     33.119      3.466      0.001      49.864     179.715
windspeed           -135.0519     36.647     -3.685      0.000    -206.894     -63.210
precipitation       1.008e+04    848.848     11.874      0.000    8415.533    1.17e+04
==============================================================================
Omnibus:                      406.032   Durbin-Watson:                   1.993
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1099.115
Skew:                           0.373   Prob(JB):                    2.14e-239
Kurtosis:                       4.955   Cond. No.                     2.25e+15
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The smallest eigenvalue is 2.13e-23. This might indicate that there are
strong multicollinearity problems or that the design matrix is singular.
-------------------------------------------------Elapsed Time --- 0.03457999229431152344 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------(12) Define the OSR2 Helper function
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00000071525573730469 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------(13) Calculate OSR2
----------------------------------------------------------------------------------------------------
OSR2:  0.688406643477396
-------------------------------------------------Elapsed Time --- 0.00299310684204101562 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(14) Fit Decision Tree Regressor
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(max_depth=3, random_state=42)
-------------------------------------------------Elapsed Time --- 0.00050210952758789062 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(15) Fit Show X df Head
----------------------------------------------------------------------------------------------------
     month day hour day_of_week holiday   temp  temp_wb  rel_humidity  windspeed  precipitation
5156     8   9   14         Thu       0  154.2       74            61         10          1.000
6290     9  26    1         Wed       0  129.0       68            90          5          1.000
2646     4  26   19         Thu       0  105.6       49            53         13          1.000
439      1  21   16         Sun       1   85.8       39            51          5          1.000
1379     3   2   16         Fri       0   76.8       39            86         46          0.075
-------------------------------------------------Elapsed Time --- 0.00223827362060546875 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------(16) One-Hot Encoding
----------------------------------------------------------------------------------------------------
X shape     :  (6022, 81)
X_test shape:  (2581, 81)
-------------------------------------------------Elapsed Time --- 0.00194907188415527344 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(17) Show X.Head() after One-Hot Encoding
----------------------------------------------------------------------------------------------------
       temp  temp_wb  rel_humidity  windspeed  precipitation  ...  day_of_week_Thu  day_of_week_Tue  day_of_week_Wed  holiday_0  holiday_1
5156  154.2       74            61         10          1.000  ...             True            False            False       True      False
6290  129.0       68            90          5          1.000  ...            False            False             True       True      False
2646  105.6       49            53         13          1.000  ...             True            False            False       True      False
439    85.8       39            51          5          1.000  ...            False            False            False      False       True
1379   76.8       39            86         46          0.075  ...            False            False            False       True      False

[5 rows x 81 columns]
-------------------------------------------------Elapsed Time --- 0.01083397865295410156 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
------------------------------------------------------------(18) Build a CART wih default parameters
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(max_depth=3, random_state=42)
-------------------------------------------------Elapsed Time --- 0.00673484802246093750 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------(19) OSR2 for Decision Tree Regressor
----------------------------------------------------------------------------------------------------
OSR2 TRAIN: 0.3905604792972712
-------------------------------------------------Elapsed Time --- 0.00144791603088378906 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------(20) Show how big the tree is
----------------------------------------------------------------------------------------------------
Tree Shape (Node Count, Tree Depth):  (15, 3)
-------------------------------------------------Elapsed Time --- 0.00000429153442382812 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------(21) Show the Test OSR2 before pruning
----------------------------------------------------------------------------------------------------
OSR2 TEST:  0.34742718249419957
-------------------------------------------------Elapsed Time --- 0.00069785118103027344 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------(22) Create Tree after Pruning
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(random_state=42)
-------------------------------------------------Elapsed Time --- 0.00007820129394531250 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------------------------(23) Compute the cost-complexity pruning path
----------------------------------------------------------------------------------------------------
Path:  {'ccp_alphas': array([0.00000000e+00, 1.00464962e+00, 1.00464962e+00, ...,
       3.20231237e+07, 6.38927192e+07, 1.14395259e+08], shape=(5185,)), 'impurities': array([0.00000000e+00, 1.00464962e+00, 2.00929924e+00, ...,
       4.57623206e+08, 5.21515925e+08, 6.35911185e+08], shape=(5185,))}
-------------------------------------------------Elapsed Time --- 0.07434582710266113281 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------(24) Extracts and shows the cost-complexity pruning information
----------------------------------------------------------------------------------------------------
CCP Alphas:  5185
Impurities:  5185
Alphas    :  5185
-------------------------------------------------Elapsed Time --- 0.00007200241088867188 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------(25) Show the total number of alpha values
----------------------------------------------------------------------------------------------------
Number of alpha values: 5185
-------------------------------------------------Elapsed Time --- 0.00000214576721191406 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------(26) Generate about ~50 trees, evenly sampled from this group
----------------------------------------------------------------------------------------------------
Number of small alpha values created: 52
-------------------------------------------------Elapsed Time --- 0.00000286102294921875 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------(27) Train and evaluate multiple decision tree models
----------------------------------------------------------------------------------------------------
R2 Quantity  :  52
OSR2 Quantity:  52
-------------------------------------------------Elapsed Time --- 3.01484012603759765625 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
------------------------------------------------(28) Extract the tree corresponding to the best OSR2
----------------------------------------------------------------------------------------------------
Optimal index     : 2
Optimal alpha     : 112830.96658742253
Optimal R^2       : 0.9400676657531316
Optimal OSR^2     : 0.7976630986012803
Optimal node count: 751
-------------------------------------------------Elapsed Time --- 0.00004625320434570312 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------(29) Trains a decision tree regressor using the optimal pruning parameter
----------------------------------------------------------------------------------------------------
Tree node count:  751
Tree max depth :  29
-------------------------------------------------Elapsed Time --- 0.07710218429565429688 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------(30) Show key parameters of the tree
----------------------------------------------------------------------------------------------------
Tree node count    :  751
Tree max depth     :  29
Tree ccp_alpha     :  112830.96658742253
Tree impurity      :  751
Tree children_left :  751
Tree children_right:  751
Tree feature       :  751
Tree threshold     :  751
Tree value         :  751
Tree value shape   :  (751, 1, 1)
-------------------------------------------------Elapsed Time --- 0.00003933906555175781 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------(31) Creates a function to visualize a decision tree modele
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00000095367431640625 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(32) Visualize the tree
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 58.52773308753967285156 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------(33) Show the test OSR2 after pruning
----------------------------------------------------------------------------------------------------
OSR2:  0.7976630986012803
-------------------------------------------------Elapsed Time --- 0.00289320945739746094 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------Total Elapsed Time ---        64.82028913497924804688 seconds ---
----------------------------------------------------------------------------------------------------
(base) eneas@MBPJES14M4 Projects % python -u "/Users/eneas/Desktop/MIT/Projects/Assignment-14-1.py"
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(1) Importing Libraries
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 1.15030312538146972656 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------(2) Importing Data
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00537610054016113281 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------(3) Data Exploration
----------------------------------------------------------------------------------------------------
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 8603 entries, 0 to 8602
Data columns (total 11 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   attendees      8603 non-null   int64  
 1   month          8603 non-null   int64  
 2   day            8603 non-null   int64  
 3   hour           8603 non-null   int64  
 4   day_of_week    8603 non-null   object 
 5   holiday        8603 non-null   int64  
 6   temp           8603 non-null   float64
 7   temp_wb        8603 non-null   int64  
 8   rel_humidity   8603 non-null   int64  
 9   windspeed      8603 non-null   int64  
 10  precipitation  8603 non-null   float64
dtypes: float64(2), int64(8), object(1)
memory usage: 739.4+ KB
-------------------------------------------------Elapsed Time --- 0.00160384178161621094 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(4) Data Cleaning - Categorical Variables
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00104904174804687500 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------(5) Data Exploration
----------------------------------------------------------------------------------------------------
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 8603 entries, 0 to 8602
Data columns (total 11 columns):
 #   Column         Non-Null Count  Dtype   
---  ------         --------------  -----   
 0   attendees      8603 non-null   int64   
 1   month          8603 non-null   category
 2   day            8603 non-null   category
 3   hour           8603 non-null   category
 4   day_of_week    8603 non-null   category
 5   holiday        8603 non-null   category
 6   temp           8603 non-null   float64 
 7   temp_wb        8603 non-null   int64   
 8   rel_humidity   8603 non-null   int64   
 9   windspeed      8603 non-null   int64   
 10  precipitation  8603 non-null   float64 
dtypes: category(5), float64(2), int64(4)
memory usage: 448.3 KB
----------------------------------------------------------------------------------------------------
<bound method DataFrame.items of       attendees month day hour day_of_week holiday  temp  temp_wb  rel_humidity  windspeed  precipitation
0           440     1   1    0         Mon       0   6.6        0            59         16          1.000
1           660     1   1    1         Mon       0   4.8        0            59         11          1.000
2           660     1   1    2         Mon       0   4.8       -1            54         21          1.000
3           110     1   1    5         Mon       0   3.0       -2            54         18          1.000
4           330     1   1    6         Mon       0   3.0       -2            54         15          1.000
...         ...   ...  ..  ...         ...     ...   ...      ...           ...        ...            ...
8598       3960    12  31   19         Mon       0  73.2       36            76         13          0.050
8599       2750    12  31   20         Mon       0  71.4       36            86         14          0.100
8600       1430    12  31   21         Mon       0  69.6       36            89         15          0.175
8601        660    12  31   22         Mon       0  71.4       37            89         14          0.225
8602        770    12  31   23         Mon       0  73.2       38            89         17          0.475

[8603 rows x 11 columns]>
----------------------------------------------------------------------------------------------------
Index           :  RangeIndex(start=0, stop=8603, step=1)
----------------------------------------------------------------------------------------------------
           attendees         temp      temp_wb  rel_humidity    windspeed  precipitation
count    8603.000000  8603.000000  8603.000000   8603.000000  8603.000000    8603.000000
mean    22559.436243    98.778287    47.835871     67.105196    11.101476       0.930024
std     24975.770785    32.920431    16.913790     18.923185     5.455005       0.242744
min       110.000000    -0.600000    -3.000000     16.000000     0.000000       0.025000
25%      3520.000000    71.400000    34.000000     53.000000     7.000000       1.000000
50%     13200.000000    96.600000    48.000000     68.000000    10.000000       1.000000
75%     33660.000000   127.200000    62.000000     84.000000    14.000000       1.000000
max    142890.000000   177.600000    81.000000    100.000000    48.000000       2.800000
----------------------------------------------------------------------------------------------------
Rows and Columns:  (8603, 11)
----------------------------------------------------------------------------------------------------
Column Names    :  Index(['attendees', 'month', 'day', 'hour', 'day_of_week', 'holiday', 'temp',
       'temp_wb', 'rel_humidity', 'windspeed', 'precipitation'],
      dtype='object')
-------------------------------------------------Elapsed Time --- 0.00932502746582031250 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(6) Data Exploration - Histogram
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.79740405082702636719 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(7) Data Exploration - Sample Data - Head
----------------------------------------------------------------------------------------------------
   attendees month day hour day_of_week holiday  temp  temp_wb  rel_humidity  windspeed  precipitation
0        440     1   1    0         Mon       0   6.6        0            59         16            1.0
1        660     1   1    1         Mon       0   4.8        0            59         11            1.0
2        660     1   1    2         Mon       0   4.8       -1            54         21            1.0
3        110     1   1    5         Mon       0   3.0       -2            54         18            1.0
4        330     1   1    6         Mon       0   3.0       -2            54         15            1.0
5        330     1   1    7         Mon       0   3.0       -2            54         11            1.0
6        220     1   1    8         Mon       0   4.8       -1            51         15            1.0
7        880     1   1    9         Mon       0  10.2        2            49         18            1.0
8       1320     1   1   10         Mon       0  15.6        4            45         21            1.0
9       1760     1   1   11         Mon       0  19.2        6            43         16            1.0
-------------------------------------------------Elapsed Time --- 0.00273919105529785156 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------(8) Data Splitting - Train and Test
----------------------------------------------------------------------------------------------------
Train data: 6022
Test data : 2581
Total data: 8603
-------------------------------------------------Elapsed Time --- 0.00064611434936523438 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------(9) Data Splitting - X and y - X_train and y_train
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00030612945556640625 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------(10) Data Splitting - Create Linear Regression Formula
----------------------------------------------------------------------------------------------------
Formula:  attendees ~ month+day+hour+day_of_week+holiday+temp+temp_wb+rel_humidity+windspeed+precipitation
-------------------------------------------------Elapsed Time --- 0.00001621246337890625 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(11) Fit Linear Regression Model
----------------------------------------------------------------------------------------------------
                            OLS Regression Results                            
==============================================================================
Dep. Variable:              attendees   R-squared:                       0.695
Model:                            OLS   Adj. R-squared:                  0.691
Method:                 Least Squares   F-statistic:                     180.7
Date:                Tue, 06 May 2025   Prob (F-statistic):               0.00
Time:                        14:43:19   Log-Likelihood:                -66004.
No. Observations:                6022   AIC:                         1.322e+05
Df Residuals:                    5946   BIC:                         1.327e+05
Df Model:                          75                                         
Covariance Type:            nonrobust                                         
======================================================================================
                         coef    std err          t      P>|t|      [0.025      0.975]
--------------------------------------------------------------------------------------
Intercept          -3.575e+04   3059.416    -11.684      0.000   -4.17e+04   -2.98e+04
month[T.2]          3110.3229    952.018      3.267      0.001    1244.022    4976.624
month[T.3]          2074.2791    945.327      2.194      0.028     221.096    3927.463
month[T.4]          5207.7716    967.047      5.385      0.000    3312.008    7103.535
month[T.5]          1.099e+04   1151.300      9.542      0.000    8728.743    1.32e+04
month[T.6]          1.437e+04   1240.137     11.584      0.000    1.19e+04    1.68e+04
month[T.7]          1.535e+04   1401.392     10.955      0.000    1.26e+04    1.81e+04
month[T.8]          1.514e+04   1419.848     10.662      0.000    1.24e+04    1.79e+04
month[T.9]          2.079e+04   1292.558     16.086      0.000    1.83e+04    2.33e+04
month[T.10]         1.798e+04   1071.415     16.781      0.000    1.59e+04    2.01e+04
month[T.11]         9988.9448    969.195     10.306      0.000    8088.971    1.19e+04
month[T.12]         4380.7284    928.038      4.720      0.000    2561.436    6200.021
day[T.2]           -2420.3577   1405.876     -1.722      0.085   -5176.385     335.669
day[T.3]           -1135.7559   1403.445     -0.809      0.418   -3887.018    1615.506
day[T.4]           -2141.3127   1431.131     -1.496      0.135   -4946.849     664.224
day[T.5]               7.6914   1418.553      0.005      0.996   -2773.188    2788.571
day[T.6]            -616.8669   1406.115     -0.439      0.661   -3373.364    2139.630
day[T.7]            2061.1264   1416.950      1.455      0.146    -716.610    4838.863
day[T.8]             152.4361   1385.647      0.110      0.912   -2563.935    2868.807
day[T.9]            -303.7730   1404.727     -0.216      0.829   -3057.548    2450.002
day[T.10]            498.1928   1390.235      0.358      0.720   -2227.172    3223.558
day[T.11]            139.1472   1400.706      0.099      0.921   -2606.745    2885.040
day[T.12]             97.0152   1399.101      0.069      0.945   -2645.730    2839.760
day[T.13]            539.2754   1448.851      0.372      0.710   -2300.999    3379.550
day[T.14]           3291.6297   1414.998      2.326      0.020     517.721    6065.539
day[T.15]            741.6481   1392.079      0.533      0.594   -1987.332    3470.628
day[T.16]            560.6142   1436.674      0.390      0.696   -2255.789    3377.017
day[T.17]            423.9306   1409.608      0.301      0.764   -2339.413    3187.274
day[T.18]           -776.0686   1403.540     -0.553      0.580   -3527.516    1975.379
day[T.19]           -817.2770   1407.753     -0.581      0.562   -3576.984    1942.430
day[T.20]           1944.6002   1389.347      1.400      0.162    -779.025    4668.225
day[T.21]            843.7644   1411.828      0.598      0.550   -1923.931    3611.460
day[T.22]          -2515.2232   1413.080     -1.780      0.075   -5285.373     254.926
day[T.23]          -1300.5669   1407.868     -0.924      0.356   -4060.500    1459.366
day[T.24]           -614.1765   1393.093     -0.441      0.659   -3345.145    2116.792
day[T.25]          -1687.6345   1396.148     -1.209      0.227   -4424.591    1049.322
day[T.26]           -781.2472   1391.102     -0.562      0.574   -3508.312    1945.818
day[T.27]          -1499.5584   1409.527     -1.064      0.287   -4262.743    1263.626
day[T.28]          -1928.9510   1409.412     -1.369      0.171   -4691.911     834.009
day[T.29]           -666.0194   1433.632     -0.465      0.642   -3476.458    2144.420
day[T.30]           -447.0490   1431.289     -0.312      0.755   -3252.894    2358.796
day[T.31]           1941.1185   1649.695      1.177      0.239   -1292.883    5175.120
hour[T.1]          -1593.0540   1251.303     -1.273      0.203   -4046.062     859.954
hour[T.2]          -3136.9880   1269.210     -2.472      0.013   -5625.101    -648.875
hour[T.3]          -5317.4603   1333.756     -3.987      0.000   -7932.107   -2702.814
hour[T.4]          -3153.6667   1282.608     -2.459      0.014   -5668.045    -639.289
hour[T.5]          -1367.6396   1280.527     -1.068      0.286   -3877.938    1142.659
hour[T.6]           5811.7031   1305.534      4.452      0.000    3252.383    8371.024
hour[T.7]           2.472e+04   1268.276     19.488      0.000    2.22e+04    2.72e+04
hour[T.8]           4.467e+04   1272.372     35.107      0.000    4.22e+04    4.72e+04
hour[T.9]           2.298e+04   1287.819     17.848      0.000    2.05e+04    2.55e+04
hour[T.10]          1.416e+04   1292.717     10.952      0.000    1.16e+04    1.67e+04
hour[T.11]          1.645e+04   1300.956     12.646      0.000    1.39e+04     1.9e+04
hour[T.12]           2.04e+04   1301.879     15.670      0.000    1.78e+04     2.3e+04
hour[T.13]          1.951e+04   1295.077     15.063      0.000     1.7e+04     2.2e+04
hour[T.14]          1.963e+04   1281.165     15.325      0.000    1.71e+04    2.21e+04
hour[T.15]          2.377e+04   1285.691     18.485      0.000    2.12e+04    2.63e+04
hour[T.16]          3.905e+04   1286.595     30.351      0.000    3.65e+04    4.16e+04
hour[T.17]          5.449e+04   1288.906     42.276      0.000     5.2e+04     5.7e+04
hour[T.18]          3.816e+04   1275.107     29.925      0.000    3.57e+04    4.07e+04
hour[T.19]          2.561e+04   1272.935     20.121      0.000    2.31e+04    2.81e+04
hour[T.20]          1.571e+04   1279.673     12.276      0.000    1.32e+04    1.82e+04
hour[T.21]          1.066e+04   1277.236      8.347      0.000    8157.451    1.32e+04
hour[T.22]          6512.9264   1279.406      5.091      0.000    4004.826    9021.027
hour[T.23]          3186.6619   1254.346      2.540      0.011     727.689    5645.635
day_of_week[T.Mon] -1426.1284    678.476     -2.102      0.036   -2756.187     -96.069
day_of_week[T.Sat] -1908.9408    398.596     -4.789      0.000   -2690.334   -1127.548
day_of_week[T.Sun] -2651.1770    397.148     -6.676      0.000   -3429.731   -1872.623
day_of_week[T.Thu]   513.8702    696.986      0.737      0.461    -852.475    1880.215
day_of_week[T.Tue]  -770.5605    686.317     -1.123      0.262   -2115.991     574.870
day_of_week[T.Wed]   480.5871    692.796      0.694      0.488    -877.544    1838.719
holiday[T.1]       -4560.1178    397.123    -11.483      0.000   -5338.623   -3781.612
temp                 825.8548     81.442     10.140      0.000     666.199     985.510
temp_wb            -1315.3162    170.757     -7.703      0.000   -1650.061    -980.571
rel_humidity         114.7896     33.119      3.466      0.001      49.864     179.715
windspeed           -135.0519     36.647     -3.685      0.000    -206.894     -63.210
precipitation       1.008e+04    848.848     11.874      0.000    8415.533    1.17e+04
==============================================================================
Omnibus:                      406.032   Durbin-Watson:                   1.993
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1099.115
Skew:                           0.373   Prob(JB):                    2.14e-239
Kurtosis:                       4.955   Cond. No.                     2.25e+15
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The smallest eigenvalue is 2.13e-23. This might indicate that there are
strong multicollinearity problems or that the design matrix is singular.
-------------------------------------------------Elapsed Time --- 0.02772521972656250000 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------(12) Define the OSR2 Helper function
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00000095367431640625 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------(13) Calculate OSR2
----------------------------------------------------------------------------------------------------
OSR2:  0.688406643477396
-------------------------------------------------Elapsed Time --- 0.00313901901245117188 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------------(14) Fit Decision Tree Regressor
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(max_depth=3, random_state=42)
-------------------------------------------------Elapsed Time --- 0.00050473213195800781 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(15) Fit Show X df Head
----------------------------------------------------------------------------------------------------
     month day hour day_of_week holiday   temp  temp_wb  rel_humidity  windspeed  precipitation
5156     8   9   14         Thu       0  154.2       74            61         10          1.000
6290     9  26    1         Wed       0  129.0       68            90          5          1.000
2646     4  26   19         Thu       0  105.6       49            53         13          1.000
439      1  21   16         Sun       1   85.8       39            51          5          1.000
1379     3   2   16         Fri       0   76.8       39            86         46          0.075
-------------------------------------------------Elapsed Time --- 0.00194811820983886719 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------(16) One-Hot Encoding
----------------------------------------------------------------------------------------------------
X shape     :  (6022, 81)
X_test shape:  (2581, 81)
-------------------------------------------------Elapsed Time --- 0.00174689292907714844 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------(17) Show X.Head() after One-Hot Encoding
----------------------------------------------------------------------------------------------------
       temp  temp_wb  rel_humidity  windspeed  precipitation  ...  day_of_week_Thu  day_of_week_Tue  day_of_week_Wed  holiday_0  holiday_1
5156  154.2       74            61         10          1.000  ...             True            False            False       True      False
6290  129.0       68            90          5          1.000  ...            False            False             True       True      False
2646  105.6       49            53         13          1.000  ...             True            False            False       True      False
439    85.8       39            51          5          1.000  ...            False            False            False      False       True
1379   76.8       39            86         46          0.075  ...            False            False            False       True      False

[5 rows x 81 columns]
-------------------------------------------------Elapsed Time --- 0.01071882247924804688 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
------------------------------------------------------------(18) Build a CART wih default parameters
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(max_depth=3, random_state=42)
-------------------------------------------------Elapsed Time --- 0.00481486320495605469 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------(19) OSR2 for Decision Tree Regressor
----------------------------------------------------------------------------------------------------
OSR2 TRAIN: 0.3905604792972712
-------------------------------------------------Elapsed Time --- 0.00100398063659667969 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------(20) Show how big the tree is
----------------------------------------------------------------------------------------------------
Tree Shape (Node Count, Tree Depth):  (15, 3)
-------------------------------------------------Elapsed Time --- 0.00000429153442382812 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
--------------------------------------------------------------(21) Show the Test OSR2 before pruning
----------------------------------------------------------------------------------------------------
OSR2 TEST:  0.34742718249419957
-------------------------------------------------Elapsed Time --- 0.00076007843017578125 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------(22) Create Tree after Pruning
----------------------------------------------------------------------------------------------------
DecisionTreeRegressor(random_state=42)
-------------------------------------------------Elapsed Time --- 0.00008130073547363281 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------------------------(23) Compute the cost-complexity pruning path
----------------------------------------------------------------------------------------------------
Path:  {'ccp_alphas': array([0.00000000e+00, 1.00464962e+00, 1.00464962e+00, ...,
       3.20231237e+07, 6.38927192e+07, 1.14395259e+08], shape=(5185,)), 'impurities': array([0.00000000e+00, 1.00464962e+00, 2.00929924e+00, ...,
       4.57623206e+08, 5.21515925e+08, 6.35911185e+08], shape=(5185,))}
-------------------------------------------------Elapsed Time --- 0.07793378829956054688 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-------------------------------------(24) Extracts and shows the cost-complexity pruning information
----------------------------------------------------------------------------------------------------
CCP Alphas:  5185
Impurities:  5185
Alphas    :  5185
-------------------------------------------------Elapsed Time --- 0.00007295608520507812 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------(25) Show the total number of alpha values
----------------------------------------------------------------------------------------------------
Number of alpha values: 5185
-------------------------------------------------Elapsed Time --- 0.00000214576721191406 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------(26) Generate about ~50 trees, evenly sampled from this group
----------------------------------------------------------------------------------------------------
Number of small alpha values created: 52
-------------------------------------------------Elapsed Time --- 0.00000309944152832031 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------(27) Train and evaluate multiple decision tree models
----------------------------------------------------------------------------------------------------
R2 Quantity  :  52
OSR2 Quantity:  52
-------------------------------------------------Elapsed Time --- 2.99506306648254394531 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
------------------------------------------------(28) Extract the tree corresponding to the best OSR2
----------------------------------------------------------------------------------------------------
Optimal index     : 2
Optimal alpha     : 112830.96658742253
Optimal R^2       : 0.9400676657531316
Optimal OSR^2     : 0.7976630986012803
Optimal node count: 751
-------------------------------------------------Elapsed Time --- 0.00003790855407714844 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------(29) Trains a decision tree regressor using the optimal pruning parameter
----------------------------------------------------------------------------------------------------
Tree node count:  751
Tree max depth :  29
-------------------------------------------------Elapsed Time --- 0.07319402694702148438 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------(30) Show key parameters of the tree
----------------------------------------------------------------------------------------------------
Tree node count    :  751
Tree max depth     :  29
Tree ccp_alpha     :  112830.96658742253
Tree impurity      :  751
Tree children_left :  751
Tree children_right:  751
Tree feature       :  751
Tree threshold     :  751
Tree value         :  751
Tree value shape   :  (751, 1, 1)
-------------------------------------------------Elapsed Time --- 0.00003790855407714844 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------(31) Creates a function to visualize a decision tree modele
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 0.00000000000000000000 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------(32) Visualize the tree
----------------------------------------------------------------------------------------------------
-------------------------------------------------Elapsed Time --- 59.04047989845275878906 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
---------------------------------------------------------------(33) Show the test OSR2 after pruning
----------------------------------------------------------------------------------------------------
OSR2:  0.7976630986012803
-------------------------------------------------Elapsed Time --- 0.00130128860473632812 seconds ---
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------End of cell output
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------Total Elapsed Time ---        64.20992708206176757812 seconds ---
----------------------------------------------------------------------------------------------------
(base) eneas@MBPJES14M4 Projects % 